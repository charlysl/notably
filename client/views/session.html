<div id="session-container" class="page-container">

  <nav-bar></nav-bar>

  <div class="col content-container">
    <div class="row" id="session-header">
      <div id="session-header-container">
        <div class="left">
          <h4 ng-if="!session">
            <a class="btn-floating btn-large waves-effect waves-light" href="/">
              <i class="material-icons">arrow_back</i>
            </a>
              &nbsp; Session {{sessionId}}
          </h4>
          <h4 ng-if="session">
            <a class="btn-floating btn-large waves-effect waves-light" href="/course/{{session.meta.number}}">
              <i class="material-icons">arrow_back</i>
            </a>
            &nbsp;{{session.meta.number}}: {{session.meta.title}}
          </h4>
        </div>
        <div class="right view-selector">
          <input name="display" type="radio" id="left_option" ng-model="showOption" value="left" />
          <label for="left_option">Feed</label>
          <input name="display" type="radio" id="both_option" ng-model="showOption" value="both" />
          <label for="both_option">Both</label>
          <input name="display" type="radio" id="right_option"  ng-model="showOption" value="right" />
          <label for="right_option">Stash</label>
        </div>
      </div>
    </div>

    <div class="row feeds">
        <div ng-class="{true: 's12 m6', false: 's12'}[showOption === 'both']" class="col feeds-col" ng-hide="showOption === 'right'" >
        <div id="feed-view" class="card-panel white-text">

        <div class="row" id="feed-header" class="thin-header">
          <div class="left thin-header">Feed</div>
        </div>

        <div class="thin-text" ng-if="!feed || feed.length === 0"><em>Add a snippet!</em></div>

          <div ng-repeat="snip in feed" id="feed-snippet-{{ snip._id }}">
            <div class="card snippet-card">
              <div class="card-content">
                <div class="snippet-header">
                  <div class="left">
                    <b><a ng-href="/profile/{{snip.author}}">{{snip.author}}</a></b> posted <em am-time-ago="snip.timestamp"></em>
                  </div>
                  <div class="right valign-wrapper">
                    {{snip.saveCount}}
                    <button class="save-button snippet-button" ng-click="saveSnippet(snip._id)" id="feed-save-{{ snip._id }}"><i class="material-icons">star</i></button>
                    {{snip.flags}}
                    <button class="flag-button snippet-button" ng-click="flagSnippet(snip._id)"><i class="material-icons">flag</i></button>
                  </div>
                </div>
                 <br/>
                <p class="black-text markdown-parsed" ng-bind-html="snip.text"></p>
              </div>
            </div>
        </div>

        </div>
        </div>
        <div ng-class="{true: 's12 m6', false: 's12'}[showOption === 'both']" class="col feeds-col"  ng-hide="showOption === 'left'" id="printarea">
          <div id="stash-view" class="card-panel white-text">
          <div class="row" id="stash-header">
            <div class="left thin-header">Your Stash</div>

            <div class="right valign-wrapper">
              <a class="print-button tooltipped" data-position="left" data-delay="50" data-tooltip="Print view" ng-href="/stash/{{session.stash._id}}"><i class="material-icons">print</i></a>
            </div>
          </div>

          <div class="thin-text" ng-if="!stash || stash.length === 0"><em>Your stash is empty!</em></div>

          <div ng-repeat="snip in stash" id="stash-snippet-{{ snip._id }}">
            <div class="card snippet-card black-text">
              <div class="card-content">

                <div class="snippet-header">
                  <div class="left">
                    <b><a ng-href="/profile/{{snip.author}}">{{snip.author}}</a></b> posted <em am-time-ago="snip.timestamp"></em>
                  </div>
                  <div class="right valign-wrapper">
                    {{snip.saveCount}}
                    <button class="save-button snippet-button" ng-click="saveSnippet(snip._id)" id="stash-save-{{ snip._id }}" disabled><i class="material-icons">star</i></button>
                    {{snip.flags}}
                    <button class="flag-button snippet-button" ng-click="flagSnippet(snip._id)"><i class="material-icons">flag</i></button>
                    <button class="remove-button snippet-button" ng-click="removeSnippet(snip._id)"><i class="material-icons">clear</i></button>
                  </div>
                </div>
                 <br/>
                <p class="black-text markdown-parsed" ng-bind-html="snip.text"></p>
              </div>
            </div>
        </div>

      </div>
      </div>
    </div>

    <div class="row submit">
      <div class="card-panel" id="snippet-input-container">
        <div class="white-text thin-header">Add a snippet: </div>
          <div class="card submit-area left-align">
            <textarea placeholder="Enter notes here..." id="snippet-input-area" ng-model="snippetInput" ng-show="!preview" required> </textarea>
            <div ng-bind-html="previewText" id="snippet-preview" class="markdown-parsed" ng-if="preview"> </div>
            <button ng-click="togglePreview()" id="toggle-preview-button">
                <i class="material-icons small" ng-if="preview">mode_edit</i>
                <i class="material-icons small" ng-if="!preview">remove_red_eye</i>
            </button>
          </div>
          <button class="waves-effect waves-light btn" ng-click="addSnippet()" ng-disabled="!session || preview" type="submit">Submit Snippet</button>
      </div>
    </div>
  </div>
</div>
